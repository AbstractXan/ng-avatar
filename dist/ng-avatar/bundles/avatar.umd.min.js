!function(t,o){"object"==typeof exports&&"undefined"!=typeof module?o(exports,require("@angular/core"),require("svg.js"),require("@angular/common")):"function"==typeof define&&define.amd?define("avatar",["exports","@angular/core","svg.js","@angular/common"],o):o(t.avatar={},t.ng.core,null,t.ng.common)}(this,function(t,i,o,e){"use strict";var s=function(){return t=Object.assign||function t(t){for(var o,e=1,i=arguments.length;e<i;e++)for(var r in o=arguments[e])Object.prototype.hasOwnProperty.call(o,r)&&(t[r]=o[r]);return t},t.apply(this,arguments)},r=["#f44336","#E91E63","#9C27B0","#673AB7","#3F51B5","#2196F3","#03A9F4","#00BCD4","#009688","#4CAF50","#8BC34A","#CDDC39","#FFC107","#FF9800","#FF5722","#795548","#9E9E9E","#607D8B"],n={xs:30,"extra-small":30,sm:40,small:40,md:50,medium:50,lg:60,large:60,xl:80,"extra-large":80};n[n.xs]="xs",n[n["extra-small"]]="extra-small",n[n.sm]="sm",n[n.small]="small",n[n.md]="md",n[n.medium]="medium",n[n.lg]="lg",n[n.large]="large",n[n.xl]="xl",n[n["extra-large"]]="extra-large";var a=function l(){this.name="",this.characters=2,this.image="",this.randomColor=!1,this.bgColor=this.randomColor?r[Math.floor(Math.random()*r.length)]:"#29b6f6",this.textColor="#fff",this.size=n.md,this.fontSize=.4*this.size,this.rounded=!0,this.radius=0,this.margin=0,this.label="",this.labelBgColor="#f44336",this.labelTextColor="#fff",this.active=!0,this.uploadable=!1},p=new i.InjectionToken("config"),h=function(){function t(t){this.Avatarconfig=new a,t&&(this.Avatarconfig=s({},this.Avatarconfig,t))}return t.prototype.getAvatarConfig=function(){return this.Avatarconfig},t.decorators=[{type:i.Injectable}],t.ctorParameters=function(){return[{type:undefined,decorators:[{type:i.Inject,args:[p]}]}]},t}(),y=o,c=function(){function m(t,o,e){this._el=t,this.arg1=o,this.arg2=e,this.arg1&&(this.el=m.getElement(t),this.options=m.getOptions(o,e),this.render())}return m.isDark=function(t){var o,e,i,r=t;return r.match(/^rgb/)?(o=(r=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/))[1],i=r[2],e=r[3]):(o=(r=+("0x"+r.slice(1).replace(r.length<5&&/./g,"$&$&")))>>16,e=r>>8&255,i=255&r),Math.sqrt(o*o*.299+i*i*.587+e*e*.114)<200},m.getElement=function(t){if(!t)throw new Error("Element not provided");switch(typeof t){case"string":var o=document.getElementById(t);if(o)return o;throw new Error("Element is not present");default:return t}},m.expandProperty=function(t){var o={top:0,right:0,bottom:0,left:0};if(t)switch(typeof t){case"number":o.top=o.bottom=o.left=o.right=t;break;case"string":var e=t.split(" ").map(function(t){return+t.replace(/\D/g,"")});switch(e.length){case 1:o.top=o.bottom=o.left=o.right=e[0];break;case 2:o.left=o.right=e[1];break;case 3:o.left=o.right=e[1],o.bottom=e[2];break;case 4:o.right=e[1],o.bottom=e[2],o.left=e[3]}}return o},m.getOptions=function(t,o){var e=new a,i=s({},e);switch(typeof t){case"string":i.name=t;break;case"object":if(!t.name)throw new Error("Name is required");i=s({},i,t)}for(var r in o&&"object"==typeof o&&(i=s({},i,o)),i)"undefined"==typeof i[r]&&(i[r]=e[r]);return"string"==typeof i.size&&(i.size=n[i.size],i.size||(i.size=n.md)),i.fontSize=.4*i.size,m.isDark(i.bgColor)||(i.textColor="#000"),i.label&&!m.isDark(i.labelBgColor)&&(i.labelTextColor="#000"),s({},i)},m.prototype.update=function(t,o){var e;this.options=s({},this.options,((e={})[t]=o,e)),this.render()},m.prototype.render=function(){this.el.innerHTML="";var t,o,e,i,r,s,n,a=y(this.el),l=m.expandProperty(this.options.margin),p=l.top,h=l.right,c=l.bottom,u=l.left,f=this.getSize();if(this.options.fontSize=.4*f,a.size(f+u+h,f+p+c),(t=1==this.options.rounded?a.circle(f):a.rect(f,f).radius(this.options.radius)).fill(this.getBgColor()).attr("fill-opacity",this.options.active?1:.5).move(u,p),this.options.image){var d=this;i=a.image(this.options.image).loaded(function(){var t;(t=d.options.rounded?a.circle(f-4):a.rect(f-4,f-4).radius(d.options.radius)).move(u+2,p+2),this.size(f).center(f/2+u,f/2+p).clipWith(t)})}if(r=a.text(this.getSlug()).attr("fill-opacity",this.options.active?1:.8).fill(this.options.textColor).font({size:this.options.fontSize}).center(f/2+u,f/2+p),this.options.label&&(s=a.rect(f,.25*f).radius(2).fill(this.options.labelBgColor).attr("fill-opacity",this.options.active?1:.8).move(u,p+f-.25*f),n=a.text(this.options.label).fill(this.options.labelTextColor).font({size:.25*f}).center(f/2+u,p+f-.25*f/2)),1==this.options.uploadable){(o=1==this.options.rounded?a.circle(f):a.rect(f,f).radius(this.options.radius)).fill("grey").attr("fill-opacity",0).move(u,p);var g=this;e=a.image("../assets/images/camera.svg").loaded(function(){var t;(t=g.options.rounded?a.circle(f-4):a.rect(f-4,f-4).radius(g.options.radius)).move(u+2,p+2),this.size(.5*f).center(f/2+u,f/2+p).clipWith(t).attr("opacity",0)}),a.mouseover(function(){t.attr("fill-opacity",.25),o.attr("fill-opacity",.75),e.attr("opacity",1),r.attr("fill-opacity",.25),null!=s&&(s.attr("fill-opacity",0),n.attr("fill-opacity",.25)),null!=i&&i.attr("opacity",.25)}),a.mouseout(function(){t.attr("fill-opacity",1),o.attr("fill-opacity",0),e.attr("opacity",0),r.attr("fill-opacity",1),null!=s&&(s.attr("fill-opacity",1),n.attr("fill-opacity",1)),null!=i&&i.attr("opacity",1)})}},m.prototype.getSlug=function(){if(!this.options.name)return"";var t;if(this.options.name&&this.options.name.length){var o=this.options.name.match(/\b(\w)/g);if(o)t=o.slice(0,this.options.characters+1).join("").toUpperCase();else t=this.options.name[0];return t.slice(0,this.options.characters)}},m.prototype.getBgColor=function(){return this.options.randomColor?r[Math.floor(Math.random()*r.length)]:this.options.bgColor},m.prototype.getSize=function(){return"number"==typeof this.options.size?this.options.size:"number"==typeof n[this.options.size]?n[this.options.size]:n.md},m}(),u=function(){function t(t,o,e){this.el=t,this.avatarService=o,this.differs=e,this.upload=new i.EventEmitter,this.differ=this.differs.find({}).create(),this.options=this.avatarService.getAvatarConfig(),this.avatar=new c(this.el.nativeElement,this.image||this.name||this.options.name||this.options.image,this.options)}return t.prototype.EmitUpload=function(){1==this.uploadable&&this.upload.emit()},t.prototype.ngDoCheck=function(){var o=this;this.options=this.avatarService.getAvatarConfig(),this.options.name=this.name?this.name:this.options.name,this.options.image=this.image?this.image:this.options.image,this.options.bgColor=this.bgColor?this.bgColor:this.options.bgColor,this.options.characters=this.characters?this.characters:this.options.characters,this.options.textColor=this.textColor?this.textColor:this.options.textColor,this.options.size=this.size?this.size:this.options.size,this.options.fontSize=this.fontSize?this.fontSize:this.options.fontSize,this.options.rounded=this.rounded?this.rounded:this.options.rounded,this.options.radius=this.radius?this.radius:this.options.radius,this.options.margin=this.margin?this.margin:this.options.margin,this.options.randomColor=this.randomColor?this.randomColor:this.options.randomColor,this.options.label=this.label?this.label:this.options.label,this.options.labelBgColor=this.labelBgColor?this.labelBgColor:this.options.labelBgColor,this.options.labelTextColor=this.labelTextColor?this.labelTextColor:this.options.labelTextColor,this.options.active=this.active?this.active:this.options.active,this.options.uploadable=this.uploadable?this.uploadable:this.options.uploadable;var t=this.differ.diff(this.options);console.log(this.options),t?(console.log("change detected"),t.forEachChangedItem(function(t){return console.log("changed",t.key)}),t.forEachChangedItem(function(t){return o.avatar.update(t.key,t.currentValue)}),t.forEachAddedItem(function(t){return console.log("added ",t.key,t.currentValue)}),t.forEachAddedItem(function(t){return o.avatar.update(t.key,t.currentValue)}),t.forEachRemovedItem(function(t){return console.log("removed ",t.key)}),t.forEachRemovedItem(function(t){return o.avatar.update(t.key,t.currentValue)})):console.log("nothing changed")},t.decorators=[{type:i.Component,args:[{selector:"app-avatar",template:"\x3c!--  --\x3e",providers:[h],changeDetection:i.ChangeDetectionStrategy.OnPush}]}],t.ctorParameters=function(){return[{type:i.ElementRef},{type:h},{type:i.KeyValueDiffers}]},t.propDecorators={options:[{type:i.Input}],name:[{type:i.Input}],characters:[{type:i.Input}],image:[{type:i.Input}],bgColor:[{type:i.Input}],textColor:[{type:i.Input}],size:[{type:i.Input}],fontSize:[{type:i.Input}],rounded:[{type:i.Input}],radius:[{type:i.Input}],margin:[{type:i.Input}],randomColor:[{type:i.Input}],label:[{type:i.Input}],labelBgColor:[{type:i.Input}],labelTextColor:[{type:i.Input}],active:[{type:i.Input}],uploadable:[{type:i.Input}],upload:[{type:i.Output}],EmitUpload:[{type:i.HostListener,args:["click"]}]},t}(),f=function(){function o(){}return o.forRoot=function(t){return{ngModule:o,providers:[{provide:p,useValue:t}]}},o.decorators=[{type:i.NgModule,args:[{imports:[e.CommonModule],declarations:[u],exports:[u]}]}],o}();t.CONFIG=p,t.AvatarService=h,t.Avatar=c,t.AvatarComponent=u,t.AvatarModule=f,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=avatar.umd.min.js.map